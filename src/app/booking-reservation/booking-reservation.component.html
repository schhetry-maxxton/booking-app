<div class="result-section p-3 border">
  <!-- <div class="new-reservation d-flex justify-content-between align-items-center mb-3">
    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#reservationModal" (click)="resetSelection()">New reservation</button>
    <div class="d-flex gap-2">
      <button  (click)="showCancelled = false; showCheckedOut = false"  class="btn btn-outline-primary" style="border: none;">View Regular Reservations</button>
      <button (click)="showCancelled = true; showCheckedOut = true" class="btn btn-outline-danger" style="border: none;">View Other Reservations</button>
    </div>
  </div> -->

  <div class="modal fade modal-xl custom-modal-size" id="reservationModal" tabindex="-1" aria-labelledby="reservationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="reservationModalLabel" style="text-align: center;" (click)="onNewReservationClick()">New Reservation</h3>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="closeAllModals()"></button>
        </div>
        <div class="modal-body">
  
          <!-- Step 1: Filter Selection -->
          <div *ngIf="currentStep === 1">
            <form [formGroup]="filterForm">
              <div class="row">
                <div class="form-group col-md-6 mb-3">
                  <label for="dates" class="dateSelection form-label">Dates</label>
                  <p id="dates" class="form-control" data-bs-toggle="modal" data-bs-target="#CalendarModal">
                    <span class="date-span" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24px" height="24px"><path d="M22.5 13.5v8.25a.75.75 0 0 1-.75.75H2.25a.75.75 0 0 1-.75-.75V5.25a.75.75 0 0 1 .75-.75h19.5a.75.75 0 0 1 .75.75zm1.5 0V5.25A2.25 2.25 0 0 0 21.75 3H2.25A2.25 2.25 0 0 0 0 5.25v16.5A2.25 2.25 0 0 0 2.25 24h19.5A2.25 2.25 0 0 0 24 21.75zm-23.25-3h22.5a.75.75 0 0 0 0-1.5H.75a.75.75 0 0 0 0 1.5M7.5 6V.75a.75.75 0 0 0-1.5 0V6a.75.75 0 0 0 1.5 0M18 6V.75a.75.75 0 0 0-1.5 0V6A.75.75 0 0 0 18 6M5.095 14.03a.75.75 0 1 0 1.06-1.06.75.75 0 0 0-1.06 1.06m.53-1.28a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25.75.75 0 0 0 0 1.5.375.375 0 1 1 0-.75.375.375 0 0 1 0 .75.75.75 0 0 0 0-1.5m-.53 6.53a.75.75 0 1 0 1.06-1.06.75.75 0 0 0-1.06 1.06m.53-1.28a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25.75.75 0 0 0 0 1.5.375.375 0 1 1 0-.75.375.375 0 0 1 0 .75.75.75 0 0 0 0-1.5m5.845-3.97a.75.75 0 1 0 1.06-1.06.75.75 0 0 0-1.06 1.06m.53-1.28A1.125 1.125 0 1 0 12 15a1.125 1.125 0 0 0 0-2.25.75.75 0 0 0 0 1.5.375.375 0 1 1 0-.75.375.375 0 0 1 0 .75.75.75 0 0 0 0-1.5m-.53 6.53a.75.75 0 1 0 1.06-1.06.75.75 0 0 0-1.06 1.06M12 18a1.125 1.125 0 1 0 0 2.25A1.125 1.125 0 0 0 12 18a.75.75 0 0 0 0 1.5.375.375 0 1 1 0-.75.375.375 0 0 1 0 .75.75.75 0 0 0 0-1.5m5.845-3.97a.75.75 0 1 0 1.06-1.06.75.75 0 0 0-1.06 1.06m.53-1.28a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25.75.75 0 0 0 0 1.5.375.375 0 1 1 0-.75.375.375 0 0 1 0 .75.75.75 0 0 0 0-1.5"></path></svg></span>
                    {{ selectedDatesDisplay || ' Checkin date - Checkout date' }}
                  </p>
                </div>
                
                <div class="form-group col-md-6 mb-3">
                  <label for="numberOfPersons" class="guestSelection form-label">Guests</label>
                  <input id="numberOfPersons" type="number" formControlName="numberOfPersons" class="form-control">
                </div>
              </div>
              <p *ngIf="!isBookingAllowed()" class="text-danger text-center mb-3">
                Please select both check-in and check-out dates to proceed.
              </p>

              <div class="text-center">
                <button type="button" class="btn btn-primary" (click)="nextStep()" [disabled]="!isBookingAllowed()">Next</button>
              </div>
            </form>
          </div>

          <div *ngIf="currentStep === 2">
            <div *ngIf="isFilterApplied && filteredRooms.length === 0" class="no-rooms-found text-center">
              <p>No rooms found matching your search criteria.</p>
            </div>
            
            <div class="container my-2" *ngIf="filteredRooms.length > 0">
              <h4 style="text-align: center;">Available Rooms</h4>
              <table class="table table-striped table-bordered table-hover">
                <thead class="thead-dark">
                  <tr>
                    <th>Room ID</th>
                    <th>Room Name</th>
                    <th>Location</th>
                    <th>Price per Night</th>
                    <th>Guest Capacity</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let room of filteredRooms">
                    <td>{{ room.roomId }}</td>
                    <td>{{ room.roomName }}</td>
                    <td>{{ room.locationName }}</td>
                    <td>{{ room.pricePerDayPerPerson }}</td>
                    <td>{{ room.guestCapacity }}</td>
                    <td>
                      <button class="btn btn-outline-primary" (click)="openBookingModal(room)">
                        Book Now
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="text-center">
              <button type="button" class="btn btn-secondary me-2" (click)="previousStep()">Previous</button>
            </div>
          </div>
          
        </div>
      </div>
    </div>
  </div>

  
<!-- <h3 style="color: darkcyan; text-align: center;" *ngIf="!showCancelled && !showCheckedOut">
  Reservations
</h3>

<table class="table table-light table-striped table-hover reservation-table mt-4" *ngIf="!showCancelled && !showCheckedOut">
  <thead class="thead-dark">
    <tr>
      <th>Reservation ID</th>
      <th>Customer Name</th>
      <th>Room ID</th>
      <th>Customer ID</th>
      <th>Arrival Date</th>
      <th>Departure Date</th>
      <th>Reservation Date</th>
      <th>Status</th>
      <th>Update Status</th>
      <th>Total Price</th>
      <th>Paid Amount</th>
      <th>Due Amount</th>
      <th>Number of Guests</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let reservation of reservations">
      <td>{{ reservation.reservationId }}</td>
      <td>{{ reservation.firstName }} {{ reservation.middleName ? reservation.middleName + ' ' : '' }} {{ reservation.lastName }}</td>
      <td>{{ reservation.roomId }}</td>
      <td>{{ reservation.customerId }}</td>
      <td>{{ reservation.arrivalDate | date:'yyyy-MM-dd' }}</td>
      <td>{{ reservation.departureDate | date:'yyyy-MM-dd' }}</td>
      <td>{{ reservation.reservationDate | date:'yyyy-MM-dd HH:mm:ss' }}</td>
      <td>{{ reservation.status }}</td>
      <td>
        <button 
          *ngIf="reservation.status === 'CONFIRM'" 
          class="btn btn-success" 
          (click)="onStatusChange(reservation, 'CHECKED-IN')"
          [disabled]="!isCheckInAvailable(reservation)">
          Check-In
        </button>
        <button 
          *ngIf="reservation.status === 'CHECKED-IN'" 
          class="btn btn-warning" 
          (click)="onStatusChange(reservation, 'CHECKED-OUT')"
          [disabled]="!isCheckOutAvailable(reservation)"
          >
          Check-Out
        </button>
      </td>
      
      <td>{{ reservation.totalPrice }}</td>
      <td>{{ reservation.paidAmount }}</td>
      <td>{{ reservation.dueAmount }}</td>
      <td>{{ reservation.numberOfGuest }}</td>
      <td>
        <button *ngIf="isCancellable(reservation)" class="btn btn-secondary" (click)="cancelReservation(reservation)">Cancel</button>
      </td>
    </tr>
  </tbody>
</table>

<h3 style="color: darkcyan; text-align: center;" *ngIf="showCancelled && showCheckedOut">
  Cancelled Reservations
</h3>
<table class="table table-light table-striped table-hover reservation-table mt-4" *ngIf="showCancelled && showCheckedOut && cancelledReservations.length > 0"> 
  <thead class="thead-dark">
    <tr>
      <th>Reservation ID</th>
      <th>Customer Name</th>
      <th>Room ID</th>
      <th>Customer ID</th>
      <th>Arrival Date</th>
      <th>Departure Date</th>
      <th>Reservation Date</th>
      <th>Total Price</th>
      <th>Paid Amount</th>
      <th>Due Amount</th>
      <th>Number of Guests</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let reservation of cancelledReservations">
      <td>{{ reservation.reservationId }}</td>
      <td>{{ reservation.firstName }} {{ reservation.middleName ? reservation.middleName + ' ' : '' }} {{ reservation.lastName }}</td>
      <td>{{ reservation.roomId }}</td>
      <td>{{ reservation.customerId }}</td>
      <td>{{ reservation.arrivalDate | date:'yyyy-MM-dd' }}</td>
      <td>{{ reservation.departureDate | date:'yyyy-MM-dd' }}</td>
      <td>{{ reservation.reservationDate | date:'yyyy-MM-dd HH:mm:ss' }}</td>
      <td>{{ reservation.totalPrice }}</td>
      <td>{{ reservation.paidAmount }}</td>
      <td>{{ reservation.dueAmount }}</td>
      <td>{{ reservation.numberOfGuest }}</td>
    </tr>
  </tbody>
</table>

<h3 style="color: darkcyan; text-align: center;" *ngIf="showCancelled && showCheckedOut">
  Checked Out Reservations
</h3>

<table class="table table-light table-striped table-hover reservation-table mt-4" *ngIf="showCancelled && showCheckedOut && checkedOutReservations.length > 0">
  <thead class="thead-dark">
    <tr>
      <th>Reservation ID</th>
      <th>Customer Name</th>
      <th>Room ID</th>
      <th>Customer ID</th>
      <th>Arrival Date</th>
      <th>Departure Date</th>
      <th>Reservation Date</th>
      <th>Total Price</th>
      <th>Paid Amount</th>
      <th>Due Amount</th>
      <th>Number of Guests</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let reservation of checkedOutReservations">
      <td>{{ reservation.reservationId }}</td>
      <td>{{ reservation.firstName }} {{ reservation.middleName ? reservation.middleName + ' ' : '' }} {{ reservation.lastName }}</td>
      <td>{{ reservation.roomId }}</td>
      <td>{{ reservation.customerId }}</td>
      <td>{{ reservation.arrivalDate | date:'yyyy-MM-dd' }}</td>
      <td>{{ reservation.departureDate | date:'yyyy-MM-dd' }}</td>
      <td>{{ reservation.reservationDate | date:'yyyy-MM-dd HH:mm:ss' }}</td>
      <td>{{ reservation.totalPrice }}</td>
      <td>{{ reservation.paidAmount }}</td>
      <td>{{ reservation.dueAmount }}</td>
      <td>{{ reservation.numberOfGuest }}</td>
    </tr>
  </tbody>
</table>
</div>
 -->

<!-- Bootstrap Tabs -->
<!-- Bootstrap Tabs -->
<div class="new-reservation d-flex justify-content-between align-items-center mb-3">
  <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#reservationModal" (click)="resetSelection()">New reservation</button>
  
  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button 
        class="nav-link" 
        [ngClass]="{'active': activeTab === 'active'}" 
        (click)="setActiveTab('active')"
        [attr.aria-selected]="activeTab === 'active'">
        Active Reservations
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button 
        class="nav-link" 
        [ngClass]="{'active': activeTab === 'cancelled'}" 
        (click)="setActiveTab('cancelled')"
        [attr.aria-selected]="activeTab === 'cancelled'">
        Cancelled Reservations
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button 
        class="nav-link" 
        [ngClass]="{'active': activeTab === 'checked-out'}" 
        (click)="setActiveTab('checked-out')"
        [attr.aria-selected]="activeTab === 'checked-out'">
        Checked-Out Reservations
      </button>
    </li>
  </ul>
</div>


<div class="tab-content mt-3">
  <!-- Active Reservations Tab -->
  <div *ngIf="activeTab === 'active'" class="tab-pane fade show active">
    <h3 style="color: darkcyan; text-align: center;">Active Reservations</h3>
    <table class="table table-light table-striped table-hover reservation-table mt-4">
      <thead class="thead-dark">
        <tr>
          <!-- Columns for Active Reservations -->
          <th>Reservation ID</th>
          <th>Customer Name</th>
          <th>Room ID</th>
          <th>Customer ID</th>
          <th>Arrival Date</th>
          <th>Departure Date</th>
          <th>Reservation Date</th>
          <th>Status</th>
          <th>Update Status</th>
          <th>Total Price</th>
          <th>Paid Amount</th>
          <th>Due Amount</th>
          <th>Number of Guests</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let reservation of reservations">
          <!-- Data rows for Active Reservations -->
          <td>{{ reservation.reservationId }}</td>
          <td>{{ reservation.firstName }} {{ reservation.middleName ? reservation.middleName + ' ' : '' }} {{ reservation.lastName }}</td>
          <td>{{ reservation.roomId }}</td>
          <td>{{ reservation.customerId }}</td>
          <td>{{ reservation.arrivalDate | date:'yyyy-MM-dd' }}</td>
          <td>{{ reservation.departureDate | date:'yyyy-MM-dd' }}</td>
          <td>{{ reservation.reservationDate | date:'yyyy-MM-dd HH:mm:ss' }}</td>
          <td>{{ reservation.status }}</td>
          <td>
            <button *ngIf="reservation.status === 'CONFIRM'" class="btn btn-success" 
                    (click)="onStatusChange(reservation, 'CHECKED-IN')" 
                    [disabled]="!isCheckInAvailable(reservation)">
              Check-In
            </button>
            <button 
              *ngIf="reservation.status === 'CHECKED-IN'" 
              class="btn btn-warning" 
              [disabled]="!isCheckOutAvailable(reservation)"
              (click)="isCheckOutAvailable(reservation) ? onStatusChange(reservation, 'CHECKED-OUT') : showCheckOutError(reservation)">
              Check-Out
            </button>
          </td>
          <td>{{ reservation.totalPrice }}</td>
          <td>{{ reservation.paidAmount }}</td>
          <td>{{ reservation.dueAmount }}</td>
          <td>{{ reservation.numberOfGuest }}</td>
          <td>
            <button *ngIf="isCancellable(reservation)" class="btn btn-secondary" 
                    (click)="cancelReservation(reservation)">
              Cancel
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Cancelled Reservations Tab -->
  <div *ngIf="activeTab === 'cancelled'" class="tab-pane fade show active">
    <h3 style="color: darkcyan; text-align: center;">Cancelled Reservations</h3>
    <table class="table table-light table-striped table-hover reservation-table mt-4">
      <thead class="thead-dark">
        <tr>
          <!-- Columns for Cancelled Reservations -->
          <th>Reservation ID</th>
          <th>Customer Name</th>
          <th>Room ID</th>
          <th>Customer ID</th>
          <th>Arrival Date</th>
          <th>Departure Date</th>
          <th>Reservation Date</th>
          <th>Total Price</th>
          <th>Paid Amount</th>
          <th>Due Amount</th>
          <th>Number of Guests</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let reservation of cancelledReservations">
          <!-- Data rows for Cancelled Reservations -->
          <td>{{ reservation.reservationId }}</td>
          <td>{{ reservation.firstName }} {{ reservation.middleName ? reservation.middleName + ' ' : '' }} {{ reservation.lastName }}</td>
          <td>{{ reservation.roomId }}</td>
          <td>{{ reservation.customerId }}</td>
          <td>{{ reservation.arrivalDate | date:'yyyy-MM-dd' }}</td>
          <td>{{ reservation.departureDate | date:'yyyy-MM-dd' }}</td>
          <td>{{ reservation.reservationDate | date:'yyyy-MM-dd HH:mm:ss' }}</td>
          <td>{{ reservation.totalPrice }}</td>
          <td>{{ reservation.paidAmount }}</td>
          <td>{{ reservation.dueAmount }}</td>
          <td>{{ reservation.numberOfGuest }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Checked-Out Reservations Tab -->
  <div *ngIf="activeTab === 'checked-out'" class="tab-pane fade show active">
    <h3 style="color: darkcyan; text-align: center;">Checked-Out Reservations</h3>
    <table class="table table-light table-striped table-hover reservation-table mt-4">
      <thead class="thead-dark">
        <tr>
          <!-- Columns for Checked-Out Reservations -->
          <th>Reservation ID</th>
          <th>Customer Name</th>
          <th>Room ID</th>
          <th>Customer ID</th>
          <th>Arrival Date</th>
          <th>Departure Date</th>
          <th>Reservation Date</th>
          <th>Total Price</th>
          <th>Paid Amount</th>
          <th>Due Amount</th>
          <th>Number of Guests</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let reservation of checkedOutReservations">
          <!-- Data rows for Checked-Out Reservations -->
          <td>{{ reservation.reservationId }}</td>
          <td>{{ reservation.firstName }} {{ reservation.middleName ? reservation.middleName + ' ' : '' }} {{ reservation.lastName }}</td>
          <td>{{ reservation.roomId }}</td>
          <td>{{ reservation.customerId }}</td>
          <td>{{ reservation.arrivalDate | date:'yyyy-MM-dd' }}</td>
          <td>{{ reservation.departureDate | date:'yyyy-MM-dd' }}</td>
          <td>{{ reservation.reservationDate | date:'yyyy-MM-dd HH:mm:ss' }}</td>
          <td>{{ reservation.totalPrice }}</td>
          <td>{{ reservation.paidAmount }}</td>
          <td>{{ reservation.dueAmount }}</td>
          <td>{{ reservation.numberOfGuest }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>



<div class="modal fade" id="CalendarModal" tabindex="-1" aria-labelledby="CalendarModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="CalendarModalLabel" style="color: darkcyan; text-align: center;"></h3>
        <button type="button" (click)="closeCalendarModal()"  class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row mb-3" style="width: 720px; margin: 0 auto;">
          <div class="col-6 position-relative">
            <label for="arrivalDate" class="dateSelection form-label"
            [ngClass]="{'highlight-label': highlightArrival}">Arrival Date</label>
            <input type="text" id="arrivalDate" class="form-control no-border" 
             
            [ngClass]="{'highlight': highlightArrival}"
            [value]="arrivalDateDisplay" disabled>
            <button *ngIf="selectedArrivalDate" type="button" class="clear-button" (click)="clearArrivalDate()">
              &times;
            </button>
          </div>
          <div class="col-6 position-relative">
            <label for="departureDate" class="dateSelection form-label"
            [ngClass]="{'highlight-label': highlightDeparture}">Departure Date</label>
            <input type="text" id="departureDate" class="form-control no-border" 
            [ngClass]="{'highlight': highlightDeparture}"
            [value]="departureDateDisplay" disabled>
            <button *ngIf="selectedDepartureDate" type="button" class="clear-button" (click)="clearDepartureDate()">
              &times;
            </button>
          </div>
        </div>

        <div class="calendar-controls-right" style="width: 100%; display: flex; justify-content: flex-end;">
          <button *ngIf="showPreviousButton" (click)="previousMonthClick()" class="btn calendar-nav-btn left" [disabled]="isPreviousDisabled()">prev</button>
          <button (click)="nextMonthClick()" class="btn calendar-nav-btn right">next</button>
        </div>

        <div class="calendar-container" style="width: 720px; margin: 0 auto;">
          <div class="calendar">
            <div class="month-header-left">
              <h5>{{ getMonthName(currentMonth) }} {{ currentYear }}</h5>
            </div>
            <div class="weekdays">
              <div *ngFor="let day of ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']" class="weekday">
                {{ day }}
              </div>
            </div>
            <div class="days-grid">
              <div *ngFor="let dayObj of daysInCurrentMonth"
                   [ngClass]="getCellClass(dayObj, currentMonth, currentYear)"
                   (click)="selectDate(dayObj.day, currentMonth, currentYear)"
                   class="day">
                {{ dayObj.day > 0 ? dayObj.day : '' }}
              </div>
            </div>
          </div>
          <div class="calendar">
            <div class="month-header-left">
              <h5>{{ getMonthName(nextMonth) }} {{ nextYear }}</h5>
            </div>
            <div class="weekdays">
              <div *ngFor="let day of ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']" class="weekday">
                {{ day }}
              </div>
            </div>
            <div class="days-grid">
              <div *ngFor="let dayObj of daysInNextMonth"
                   [ngClass]="getCellClass(dayObj, nextMonth, nextYear)"
                   (click)="selectDate(dayObj.day, nextMonth, nextYear)"
                   class="day">
                {{ dayObj.day > 0 ? dayObj.day : '' }}
              </div>
            </div>
          </div>
         
        </div>

        <div class="calendar-actions-container">
          <button class="btn btn-primary" (click)="saveSelection()">Confirm</button>
        </div>
      </div>
    </div>
  </div>
</div>